About to train 1 agents on (25,25) env.
Parameters:
max_num_cities: 2
max_rails_between_cities: 2
max_rails_in_city: 4
malfunction_rate: 0
max_duration: 50
min_duration: 20
num_episodes: 200
starting from episode: 0
max_steps: 404
eps_initial: 1
eps_decay_rate: 0.992
learning_rate: 0.03
learning_rate_decay: 0.1
done_reward: 0
deadlock_reward: -100
batch_size: 128
attention_0.att_l                                         (1, 4, 10)
attention_0.att_r                                         (1, 4, 10)
attention_0.bias                                               (40,)
attention_0.lin_l.weight                                    (40, 14)
attention_1.att_l                                         (1, 4, 10)
attention_1.att_r                                         (1, 4, 10)
attention_1.bias                                               (40,)
attention_1.lin_l.weight                                    (40, 40)
attention_2.att_l                                         (1, 4, 10)
attention_2.att_r                                         (1, 4, 10)
attention_2.bias                                               (40,)
attention_2.lin_l.weight                                    (40, 40)
out_att.att_l                                              (1, 1, 1)
out_att.att_r                                              (1, 1, 1)
out_att.bias                                                    (1,)
out_att.lin_l.weight                                         (1, 40)
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
filename is: test_results/
/home/runnphoenix/anaconda3/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Ep: 1	 2 Agents on (25,25).	 Ep score -96.000	Avg Score: -0.238	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.99	EP ended at step: 162/404	Mean state_value: [1.2485733]	 Epoch avg_loss: None
Ep: 2	 3 Agents on (25,25).	 Ep score -283.333	Avg Score: -0.694	 Env Dones so far: 0.00%	 Done Agents in ep: 33.33%	 In deadlock 66.67%(at switch 1)
		 Not started 0	 Eps: 0.98	EP ended at step: 412/408	Mean state_value: [1.023531]	 Epoch avg_loss: None
Ep: 3	 4 Agents on (25,25).	 Ep score -414.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)
		 Not started 0	 Eps: 0.98	EP ended at step: 416/412	Mean state_value: [1.102439]	 Epoch avg_loss: None
Ep: 4	 5 Agents on (25,25).	 Ep score -340.800	Avg Score: -0.819	 Env Dones so far: 0.00%	 Done Agents in ep: 20.00%	 In deadlock 80.00%(at switch 0)
		 Not started 0	 Eps: 0.97	EP ended at step: 420/416	Mean state_value: [1.2305005]	 Epoch avg_loss: None
Ep: 5	 6 Agents on (25,25).	 Ep score -422.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.96	EP ended at step: 424/420	Mean state_value: [1.4334893]	 Epoch avg_loss: None
Ep: 6	 7 Agents on (25,25).	 Ep score -426.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 1)
		 Not started 0	 Eps: 0.95	EP ended at step: 428/424	Mean state_value: [0.9984949]	 Epoch avg_loss: None
Ep: 7	 8 Agents on (25,25).	 Ep score -234.000	Avg Score: -0.547	 Env Dones so far: 0.00%	 Done Agents in ep: 75.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.95	EP ended at step: 432/428	Mean state_value: [1.3965716]	 Epoch avg_loss: None
/home/runnphoenix/anaconda3/lib/python3.8/site-packages/flatland/envs/rail_generators.py:780: UserWarning: Could not set all required cities!
  warnings.warn(
/home/runnphoenix/anaconda3/lib/python3.8/site-packages/flatland/envs/rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.
  warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")
Ep: 8	 1 Agents on (25,25).	 Ep score -32.000	Avg Score: -0.074	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.94	EP ended at step: 34/432	Mean state_value: [1.4312524]	 Epoch avg_loss: None
Ep: 9	 2 Agents on (25,25).	 Ep score -220.000	Avg Score: -0.545	 Env Dones so far: 0.00%	 Done Agents in ep: 50.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.93	EP ended at step: 408/404	Mean state_value: [1.2025334]	 Epoch avg_loss: None
Ep: 10	 3 Agents on (25,25).	 Ep score -287.333	Avg Score: -0.704	 Env Dones so far: 0.00%	 Done Agents in ep: 33.33%	 In deadlock 66.67%(at switch 0)
		 Not started 0	 Eps: 0.92	EP ended at step: 412/408	Mean state_value: [1.1473138]	 Epoch avg_loss: None
 --------------- TESTING STARTED ------------------
Ep: 0	 1 Agents on (25,25).	 Ep score -22.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 24/404
Ep: 1	 1 Agents on (25,25).	 Ep score -402.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 404/404
Ep: 2	 1 Agents on (25,25).	 Ep score -31.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 33/404
Ep: 0	 2 Agents on (25,25).	 Ep score -28.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 36/408
Ep: 1	 2 Agents on (25,25).	 Ep score -217.500	 Done Agents in ep: 50.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 408/408
Ep: 2	 2 Agents on (25,25).	 Ep score -112.500	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 143/408
Ep: 0	 3 Agents on (25,25).	 Ep score -410.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 412/412
Ep: 1	 3 Agents on (25,25).	 Ep score -283.667	 Done Agents in ep: 33.33%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 412/412
Ep: 2	 3 Agents on (25,25).	 Ep score -20.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 35/412
Ep: 0	 4 Agents on (25,25).	 Ep score -318.500	 Done Agents in ep: 25.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 1	 4 Agents on (25,25).	 Ep score -315.000	 Done Agents in ep: 25.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 2	 4 Agents on (25,25).	 Ep score -18.750	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 37/416
Ep: 0	 5 Agents on (25,25).	 Ep score -340.800	 Done Agents in ep: 20.00%	 In deadlock 40.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 1	 5 Agents on (25,25).	 Ep score -418.000	 Done Agents in ep: 0.00%	 In deadlock 80.00%(at switch 2)	 Not started 0	EP ended at step: 420/420
Ep: 2	 5 Agents on (25,25).	 Ep score -263.800	 Done Agents in ep: 40.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 0	 6 Agents on (25,25).	 Ep score -422.000	 Done Agents in ep: 0.00%	 In deadlock 33.33%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 1	 6 Agents on (25,25).	 Ep score -422.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 2)	 Not started 0	EP ended at step: 424/424
Ep: 2	 6 Agents on (25,25).	 Ep score -422.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 0	 7 Agents on (25,25).	 Ep score -313.857	 Done Agents in ep: 28.57%	 In deadlock 28.57%(at switch 0)	 Not started 0	EP ended at step: 428/428
Ep: 1	 7 Agents on (25,25).	 Ep score -426.000	 Done Agents in ep: 0.00%	 In deadlock 85.71%(at switch 2)	 Not started 0	EP ended at step: 428/428
Ep: 2	 7 Agents on (25,25).	 Ep score -426.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 2)	 Not started 0	EP ended at step: 428/428
Ep: 0	 8 Agents on (25,25).	 Ep score -330.875	 Done Agents in ep: 25.00%	 In deadlock 25.00%(at switch 0)	 Not started 0	EP ended at step: 432/432
Ep: 1	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 432/432
Ep: 2	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 1)	 Not started 0	EP ended at step: 432/432
AGENT: Saving local and target networks
Epoch 10, testing agents on 3: Avg. done agents: 35.28769841269842% | Avg. reward: -1517.75 | Avg. normalized reward: -28.10648148148148 | Avg. agents in deadlock: 24.692460317460316%| LR: 0.010799999999999995
Replay memory saved
Ep: 11	 4 Agents on (25,25).	 Ep score -414.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)
		 Not started 0	 Eps: 0.92	EP ended at step: 416/412	Mean state_value: [1.6796229]	 Epoch avg_loss: None
Ep: 12	 5 Agents on (25,25).	 Ep score -262.400	Avg Score: -0.631	 Env Dones so far: 0.00%	 Done Agents in ep: 40.00%	 In deadlock 60.00%(at switch 0)
		 Not started 0	 Eps: 0.91	EP ended at step: 420/416	Mean state_value: [1.3824861]	 Epoch avg_loss: None
Ep: 13	 6 Agents on (25,25).	 Ep score -357.333	Avg Score: -0.851	 Env Dones so far: 0.00%	 Done Agents in ep: 16.67%	 In deadlock 83.33%(at switch 0)
		 Not started 0	 Eps: 0.90	EP ended at step: 424/420	Mean state_value: [1.5105187]	 Epoch avg_loss: None
Ep: 14	 7 Agents on (25,25).	 Ep score -367.429	Avg Score: -0.867	 Env Dones so far: 0.00%	 Done Agents in ep: 14.29%	 In deadlock 85.71%(at switch 0)
		 Not started 0	 Eps: 0.89	EP ended at step: 428/424	Mean state_value: [1.4331214]	 Epoch avg_loss: None
Ep: 15	 8 Agents on (25,25).	 Ep score -229.375	Avg Score: -0.536	 Env Dones so far: 0.00%	 Done Agents in ep: 50.00%	 In deadlock 50.00%(at switch 1)
		 Not started 0	 Eps: 0.89	EP ended at step: 432/428	Mean state_value: [1.4002441]	 Epoch avg_loss: None
Ep: 16	 1 Agents on (25,25).	 Ep score -107.000	Avg Score: -0.248	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.88	EP ended at step: 109/432	Mean state_value: [1.1544555]	 Epoch avg_loss: None
Ep: 17	 2 Agents on (25,25).	 Ep score -232.500	Avg Score: -0.575	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.87	EP ended at step: 308/404	Mean state_value: [1.0467945]	 Epoch avg_loss: None
Ep: 18	 3 Agents on (25,25).	 Ep score -228.333	Avg Score: -0.560	 Env Dones so far: 0.00%	 Done Agents in ep: 66.67%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.87	EP ended at step: 412/408	Mean state_value: [1.2678534]	 Epoch avg_loss: None
Ep: 19	 4 Agents on (25,25).	 Ep score -314.500	Avg Score: -0.763	 Env Dones so far: 0.00%	 Done Agents in ep: 25.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.86	EP ended at step: 416/412	Mean state_value: [1.3588734]	 Epoch avg_loss: None
Ep: 20	 5 Agents on (25,25).	 Ep score -271.000	Avg Score: -0.651	 Env Dones so far: 0.00%	 Done Agents in ep: 40.00%	 In deadlock 60.00%(at switch 0)
		 Not started 0	 Eps: 0.85	EP ended at step: 420/416	Mean state_value: [1.4666858]	 Epoch avg_loss: None
 --------------- TESTING STARTED ------------------
Ep: 0	 1 Agents on (25,25).	 Ep score -22.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 24/404
Ep: 1	 1 Agents on (25,25).	 Ep score -402.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 404/404
Ep: 2	 1 Agents on (25,25).	 Ep score -31.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 33/404
Ep: 0	 2 Agents on (25,25).	 Ep score -63.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 94/408
Ep: 1	 2 Agents on (25,25).	 Ep score -217.500	 Done Agents in ep: 50.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 408/408
Ep: 2	 2 Agents on (25,25).	 Ep score -112.500	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 143/408
Ep: 0	 3 Agents on (25,25).	 Ep score -410.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 412/412
Ep: 1	 3 Agents on (25,25).	 Ep score -283.667	 Done Agents in ep: 33.33%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 412/412
Ep: 2	 3 Agents on (25,25).	 Ep score -20.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 35/412
Ep: 0	 4 Agents on (25,25).	 Ep score -318.500	 Done Agents in ep: 25.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 1	 4 Agents on (25,25).	 Ep score -315.000	 Done Agents in ep: 25.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 2	 4 Agents on (25,25).	 Ep score -18.750	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 37/416
Ep: 0	 5 Agents on (25,25).	 Ep score -340.800	 Done Agents in ep: 20.00%	 In deadlock 40.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 1	 5 Agents on (25,25).	 Ep score -340.400	 Done Agents in ep: 20.00%	 In deadlock 80.00%(at switch 2)	 Not started 0	EP ended at step: 420/420
Ep: 2	 5 Agents on (25,25).	 Ep score -263.800	 Done Agents in ep: 40.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 0	 6 Agents on (25,25).	 Ep score -292.500	 Done Agents in ep: 33.33%	 In deadlock 33.33%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 1	 6 Agents on (25,25).	 Ep score -422.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 2)	 Not started 0	EP ended at step: 424/424
Ep: 2	 6 Agents on (25,25).	 Ep score -422.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 0	 7 Agents on (25,25).	 Ep score -426.000	 Done Agents in ep: 0.00%	 In deadlock 28.57%(at switch 0)	 Not started 0	EP ended at step: 428/428
Ep: 1	 7 Agents on (25,25).	 Ep score -426.000	 Done Agents in ep: 0.00%	 In deadlock 85.71%(at switch 2)	 Not started 0	EP ended at step: 428/428
Ep: 2	 7 Agents on (25,25).	 Ep score -426.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 2)	 Not started 0	EP ended at step: 428/428
Ep: 0	 8 Agents on (25,25).	 Ep score -330.875	 Done Agents in ep: 25.00%	 In deadlock 25.00%(at switch 0)	 Not started 0	EP ended at step: 432/432
Ep: 1	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 432/432
Ep: 2	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 1)	 Not started 0	EP ended at step: 432/432
AGENT: Saving local and target networks
Epoch 20, testing agents on 3: Avg. done agents: 36.31944444444444% | Avg. reward: -1504.8333333333333 | Avg. normalized reward: -27.86728395061728 | Avg. agents in deadlock: 24.692460317460316%| LR: 0.022799999999999994
Replay memory saved
Ep: 21	 6 Agents on (25,25).	 Ep score -422.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.84	EP ended at step: 424/420	Mean state_value: [1.5582563]	 Epoch avg_loss: None
Ep: 22	 7 Agents on (25,25).	 Ep score -426.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 1)
		 Not started 0	 Eps: 0.84	EP ended at step: 428/424	Mean state_value: [1.3974102]	 Epoch avg_loss: None
Ep: 23	 8 Agents on (25,25).	 Ep score -379.750	Avg Score: -0.887	 Env Dones so far: 0.00%	 Done Agents in ep: 12.50%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.83	EP ended at step: 432/428	Mean state_value: [1.6188258]	 Epoch avg_loss: None
Ep: 24	 1 Agents on (25,25).	 Ep score -103.000	Avg Score: -0.238	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.82	EP ended at step: 105/432	Mean state_value: [1.4041238]	 Epoch avg_loss: None
Ep: 25	 2 Agents on (25,25).	 Ep score -406.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)
		 Not started 0	 Eps: 0.82	EP ended at step: 408/404	Mean state_value: [1.0799098]	 Epoch avg_loss: None
Ep: 26	 3 Agents on (25,25).	 Ep score -80.667	Avg Score: -0.198	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.81	EP ended at step: 108/408	Mean state_value: [1.3380231]	 Epoch avg_loss: None
Ep: 27	 4 Agents on (25,25).	 Ep score -291.500	Avg Score: -0.708	 Env Dones so far: 0.00%	 Done Agents in ep: 50.00%	 In deadlock 50.00%(at switch 0)
		 Not started 0	 Eps: 0.81	EP ended at step: 416/412	Mean state_value: [1.0220236]	 Epoch avg_loss: None
Ep: 28	 5 Agents on (25,25).	 Ep score -418.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)
		 Not started 0	 Eps: 0.80	EP ended at step: 420/416	Mean state_value: [1.5059791]	 Epoch avg_loss: None
Ep: 29	 6 Agents on (25,25).	 Ep score -422.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 50.00%(at switch 0)
		 Not started 0	 Eps: 0.79	EP ended at step: 424/420	Mean state_value: [1.6967944]	 Epoch avg_loss: None
/home/runnphoenix/work/flatland-rl/rainbow/dueling_double_dqn.py:270: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  batch = np.array(batch).transpose()
 ------LEARNING------
Ep: 30	 7 Agents on (25,25).	 Ep score -372.857	Avg Score: -0.879	 Env Dones so far: 0.00%	 Done Agents in ep: 14.29%	 In deadlock 85.71%(at switch 0)
		 Not started 0	 Eps: 0.79	EP ended at step: 428/424	Mean state_value: [1.5600411]	 Epoch avg_loss: 20.11614990234375
 --------------- TESTING STARTED ------------------
Ep: 0	 1 Agents on (25,25).	 Ep score -22.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 24/404
Ep: 1	 1 Agents on (25,25).	 Ep score -402.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 404/404
Ep: 2	 1 Agents on (25,25).	 Ep score -31.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 33/404
Ep: 0	 2 Agents on (25,25).	 Ep score -28.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 36/408
Ep: 1	 2 Agents on (25,25).	 Ep score -217.500	 Done Agents in ep: 50.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 408/408
Ep: 2	 2 Agents on (25,25).	 Ep score -56.500	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 87/408
Ep: 0	 3 Agents on (25,25).	 Ep score -410.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 412/412
Ep: 1	 3 Agents on (25,25).	 Ep score -283.667	 Done Agents in ep: 33.33%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 412/412
Ep: 2	 3 Agents on (25,25).	 Ep score -20.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 35/412
Ep: 0	 4 Agents on (25,25).	 Ep score -318.500	 Done Agents in ep: 25.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 1	 4 Agents on (25,25).	 Ep score -315.000	 Done Agents in ep: 25.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 2	 4 Agents on (25,25).	 Ep score -213.750	 Done Agents in ep: 50.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 0	 5 Agents on (25,25).	 Ep score -340.800	 Done Agents in ep: 20.00%	 In deadlock 40.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 1	 5 Agents on (25,25).	 Ep score -340.400	 Done Agents in ep: 20.00%	 In deadlock 80.00%(at switch 2)	 Not started 0	EP ended at step: 420/420
Ep: 2	 5 Agents on (25,25).	 Ep score -263.800	 Done Agents in ep: 40.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 0	 6 Agents on (25,25).	 Ep score -292.500	 Done Agents in ep: 33.33%	 In deadlock 33.33%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 1	 6 Agents on (25,25).	 Ep score -422.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 2)	 Not started 0	EP ended at step: 424/424
Ep: 2	 6 Agents on (25,25).	 Ep score -422.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 0	 7 Agents on (25,25).	 Ep score -313.857	 Done Agents in ep: 28.57%	 In deadlock 28.57%(at switch 0)	 Not started 0	EP ended at step: 428/428
Ep: 1	 7 Agents on (25,25).	 Ep score -367.286	 Done Agents in ep: 14.29%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 428/428
Ep: 2	 7 Agents on (25,25).	 Ep score -426.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 2)	 Not started 0	EP ended at step: 428/428
Ep: 0	 8 Agents on (25,25).	 Ep score -330.875	 Done Agents in ep: 25.00%	 In deadlock 25.00%(at switch 0)	 Not started 0	EP ended at step: 432/432
Ep: 1	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 432/432
Ep: 2	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 1)	 Not started 0	EP ended at step: 432/432
AGENT: Saving local and target networks
Epoch 30, testing agents on 3: Avg. done agents: 36.0218253968254% | Avg. reward: -1479.9166666666667 | Avg. normalized reward: -27.405864197530864 | Avg. agents in deadlock: 21.121031746031747%| LR: 0.025199999999999993
Replay memory saved
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
Ep: 31	 8 Agents on (25,25).	 Ep score -208.500	Avg Score: -0.487	 Env Dones so far: 0.00%	 Done Agents in ep: 87.50%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.78	EP ended at step: 432/428	Mean state_value: [3.0502543]	 Epoch avg_loss: 2.3797096217933453
Ep: 32	 1 Agents on (25,25).	 Ep score -32.000	Avg Score: -0.074	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.77	EP ended at step: 34/432	Mean state_value: [3.6271448]	 Epoch avg_loss: None
Ep: 33	 2 Agents on (25,25).	 Ep score -406.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)
		 Not started 0	 Eps: 0.77	EP ended at step: 408/404	Mean state_value: [3.5590436]	 Epoch avg_loss: None
 ------LEARNING------
------LEARNING------
Ep: 34	 3 Agents on (25,25).	 Ep score -66.667	Avg Score: -0.163	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.76	EP ended at step: 89/408	Mean state_value: [3.5304847]	 Epoch avg_loss: 3.0644867420196533
 ------LEARNING------
------LEARNING------
Ep: 35	 4 Agents on (25,25).	 Ep score -45.250	Avg Score: -0.110	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.75	EP ended at step: 101/412	Mean state_value: [3.55895]	 Epoch avg_loss: 1.2560909390449524
 ------LEARNING------
Ep: 36	 5 Agents on (25,25).	 Ep score -340.200	Avg Score: -0.818	 Env Dones so far: 0.00%	 Done Agents in ep: 20.00%	 In deadlock 80.00%(at switch 0)
		 Not started 0	 Eps: 0.75	EP ended at step: 420/416	Mean state_value: [3.876939]	 Epoch avg_loss: 5.40207576751709
 ------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
Ep: 37	 6 Agents on (25,25).	 Ep score -137.667	Avg Score: -0.328	 Env Dones so far: 0.00%	 Done Agents in ep: 83.33%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.74	EP ended at step: 424/420	Mean state_value: [3.837881]	 Epoch avg_loss: 1.530744656920433
 ------LEARNING------
Ep: 38	 7 Agents on (25,25).	 Ep score -426.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 28.57%(at switch 0)
		 Not started 0	 Eps: 0.74	EP ended at step: 428/424	Mean state_value: [4.4479313]	 Epoch avg_loss: 1.6341955661773682
 ------LEARNING------
------LEARNING------
Ep: 39	 8 Agents on (25,25).	 Ep score -328.250	Avg Score: -0.767	 Env Dones so far: 0.00%	 Done Agents in ep: 25.00%	 In deadlock 50.00%(at switch 1)
		 Not started 0	 Eps: 0.73	EP ended at step: 432/428	Mean state_value: [4.479662]	 Epoch avg_loss: 1.7415343523025513
 ------LEARNING------
Ep: 40	 1 Agents on (25,25).	 Ep score -112.000	Avg Score: -0.259	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.73	EP ended at step: 114/432	Mean state_value: [4.271327]	 Epoch avg_loss: 1.9641484022140503
 --------------- TESTING STARTED ------------------
Ep: 0	 1 Agents on (25,25).	 Ep score -32.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 34/404
Ep: 1	 1 Agents on (25,25).	 Ep score -402.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 404/404
Ep: 2	 1 Agents on (25,25).	 Ep score -402.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 404/404
Ep: 0	 2 Agents on (25,25).	 Ep score -214.000	 Done Agents in ep: 50.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 408/408
Ep: 1	 2 Agents on (25,25).	 Ep score -406.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 408/408
Ep: 2	 2 Agents on (25,25).	 Ep score -406.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 408/408
Ep: 0	 3 Agents on (25,25).	 Ep score -28.667	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 35/412
Ep: 1	 3 Agents on (25,25).	 Ep score -283.667	 Done Agents in ep: 33.33%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 412/412
Ep: 2	 3 Agents on (25,25).	 Ep score -146.333	 Done Agents in ep: 66.67%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 412/412
Ep: 0	 4 Agents on (25,25).	 Ep score -220.250	 Done Agents in ep: 50.00%	 In deadlock 50.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 1	 4 Agents on (25,25).	 Ep score -318.000	 Done Agents in ep: 25.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 2	 4 Agents on (25,25).	 Ep score -214.250	 Done Agents in ep: 50.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 0	 5 Agents on (25,25).	 Ep score -418.000	 Done Agents in ep: 0.00%	 In deadlock 40.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 1	 5 Agents on (25,25).	 Ep score -418.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 2	 5 Agents on (25,25).	 Ep score -105.600	 Done Agents in ep: 80.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 0	 6 Agents on (25,25).	 Ep score -422.000	 Done Agents in ep: 0.00%	 In deadlock 50.00%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 1	 6 Agents on (25,25).	 Ep score -422.000	 Done Agents in ep: 0.00%	 In deadlock 33.33%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 2	 6 Agents on (25,25).	 Ep score -291.167	 Done Agents in ep: 33.33%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 0	 7 Agents on (25,25).	 Ep score -426.000	 Done Agents in ep: 0.00%	 In deadlock 57.14%(at switch 0)	 Not started 0	EP ended at step: 428/428
Ep: 1	 7 Agents on (25,25).	 Ep score -369.714	 Done Agents in ep: 14.29%	 In deadlock 57.14%(at switch 0)	 Not started 0	EP ended at step: 428/428
Ep: 2	 7 Agents on (25,25).	 Ep score -254.714	 Done Agents in ep: 42.86%	 In deadlock 57.14%(at switch 0)	 Not started 0	EP ended at step: 428/428
Ep: 0	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 62.50%(at switch 0)	 Not started 0	EP ended at step: 432/432
Ep: 1	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 62.50%(at switch 0)	 Not started 0	EP ended at step: 432/432
Ep: 2	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)	 Not started 0	EP ended at step: 432/432
Epoch 40, testing agents on 3: Avg. done agents: 26.89484126984127% | Avg. reward: -1523.9166666666667 | Avg. normalized reward: -28.22067901234568 | Avg. agents in deadlock: 23.74007936507936%| LR: 0.013199999999999998
Replay memory saved
Ep: 41	 2 Agents on (25,25).	 Ep score -406.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)
		 Not started 0	 Eps: 0.72	EP ended at step: 408/404	Mean state_value: [4.9679723]	 Epoch avg_loss: None
Ep: 42	 3 Agents on (25,25).	 Ep score -410.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.71	EP ended at step: 412/408	Mean state_value: [4.6787133]	 Epoch avg_loss: None
 ------LEARNING------
------LEARNING------
Ep: 43	 4 Agents on (25,25).	 Ep score -314.250	Avg Score: -0.763	 Env Dones so far: 0.00%	 Done Agents in ep: 25.00%	 In deadlock 75.00%(at switch 0)
		 Not started 0	 Eps: 0.71	EP ended at step: 416/412	Mean state_value: [4.3395443]	 Epoch avg_loss: 5.053114593029022
 ------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
Ep: 44	 5 Agents on (25,25).	 Ep score -291.200	Avg Score: -0.700	 Env Dones so far: 0.00%	 Done Agents in ep: 40.00%	 In deadlock 60.00%(at switch 0)
		 Not started 0	 Eps: 0.70	EP ended at step: 420/416	Mean state_value: [4.1864953]	 Epoch avg_loss: 1.620636761188507
 ------LEARNING------
Ep: 45	 6 Agents on (25,25).	 Ep score -356.667	Avg Score: -0.849	 Env Dones so far: 0.00%	 Done Agents in ep: 16.67%	 In deadlock 83.33%(at switch 0)
		 Not started 0	 Eps: 0.70	EP ended at step: 424/420	Mean state_value: [4.165851]	 Epoch avg_loss: 6.644717693328857
 ------LEARNING------
Ep: 46	 7 Agents on (25,25).	 Ep score -311.000	Avg Score: -0.733	 Env Dones so far: 0.00%	 Done Agents in ep: 28.57%	 In deadlock 71.43%(at switch 0)
		 Not started 0	 Eps: 0.69	EP ended at step: 428/424	Mean state_value: [4.0682073]	 Epoch avg_loss: 1.9193251132965088
 ------LEARNING------
Ep: 47	 8 Agents on (25,25).	 Ep score -430.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 62.50%(at switch 0)
		 Not started 0	 Eps: 0.69	EP ended at step: 432/428	Mean state_value: [4.135904]	 Epoch avg_loss: 2.0712108612060547
 ------LEARNING------
Ep: 48	 1 Agents on (25,25).	 Ep score -70.000	Avg Score: -0.162	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.68	EP ended at step: 72/432	Mean state_value: [4.4335537]	 Epoch avg_loss: 1.4047677516937256
 ------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
Ep: 49	 2 Agents on (25,25).	 Ep score -353.500	Avg Score: -0.875	 Env Dones so far: 0.00%	 Done Agents in ep: 50.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.67	EP ended at step: 408/404	Mean state_value: [4.3768845]	 Epoch avg_loss: 4.2782425085703535
 ------LEARNING------
------LEARNING------
------LEARNING------
Ep: 50	 3 Agents on (25,25).	 Ep score -171.667	Avg Score: -0.421	 Env Dones so far: 0.00%	 Done Agents in ep: 66.67%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.67	EP ended at step: 412/408	Mean state_value: [4.489676]	 Epoch avg_loss: 1.8763643503189087
 --------------- TESTING STARTED ------------------
Ep: 0	 1 Agents on (25,25).	 Ep score -22.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 24/404
Ep: 1	 1 Agents on (25,25).	 Ep score -402.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 404/404
Ep: 2	 1 Agents on (25,25).	 Ep score -31.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 33/404
Ep: 0	 2 Agents on (25,25).	 Ep score -27.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 34/408
Ep: 1	 2 Agents on (25,25).	 Ep score -217.500	 Done Agents in ep: 50.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 408/408
Ep: 2	 2 Agents on (25,25).	 Ep score -406.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 408/408
Ep: 0	 3 Agents on (25,25).	 Ep score -29.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 35/412
Ep: 1	 3 Agents on (25,25).	 Ep score -283.667	 Done Agents in ep: 33.33%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 412/412
Ep: 2	 3 Agents on (25,25).	 Ep score -146.333	 Done Agents in ep: 66.67%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 412/412
Ep: 0	 4 Agents on (25,25).	 Ep score -220.750	 Done Agents in ep: 50.00%	 In deadlock 50.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 1	 4 Agents on (25,25).	 Ep score -221.750	 Done Agents in ep: 50.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 2	 4 Agents on (25,25).	 Ep score -214.250	 Done Agents in ep: 50.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 0	 5 Agents on (25,25).	 Ep score -418.000	 Done Agents in ep: 0.00%	 In deadlock 40.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 1	 5 Agents on (25,25).	 Ep score -418.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 2)	 Not started 0	EP ended at step: 420/420
Ep: 2	 5 Agents on (25,25).	 Ep score -184.200	 Done Agents in ep: 60.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 0	 6 Agents on (25,25).	 Ep score -422.000	 Done Agents in ep: 0.00%	 In deadlock 50.00%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 1	 6 Agents on (25,25).	 Ep score -422.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 3)	 Not started 0	EP ended at step: 424/424
Ep: 2	 6 Agents on (25,25).	 Ep score -290.500	 Done Agents in ep: 33.33%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 0	 7 Agents on (25,25).	 Ep score -426.000	 Done Agents in ep: 0.00%	 In deadlock 57.14%(at switch 0)	 Not started 0	EP ended at step: 428/428
Ep: 1	 7 Agents on (25,25).	 Ep score -313.429	 Done Agents in ep: 28.57%	 In deadlock 57.14%(at switch 0)	 Not started 0	EP ended at step: 428/428
Ep: 2	 7 Agents on (25,25).	 Ep score -199.286	 Done Agents in ep: 57.14%	 In deadlock 42.86%(at switch 0)	 Not started 0	EP ended at step: 428/428
Ep: 0	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 62.50%(at switch 0)	 Not started 0	EP ended at step: 432/432
Ep: 1	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 62.50%(at switch 0)	 Not started 0	EP ended at step: 432/432
Ep: 2	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)	 Not started 0	EP ended at step: 432/432
AGENT: Saving local and target networks
Epoch 50, testing agents on 3: Avg. done agents: 36.62698412698413% | Avg. reward: -1444.4583333333333 | Avg. normalized reward: -26.749228395061728 | Avg. agents in deadlock: 30.08928571428571%| LR: 0.001200000000000001
Replay memory saved
AGENT: Saving local and target networks
------LEARNING------
------LEARNING------
Ep: 51	 4 Agents on (25,25).	 Ep score -318.000	Avg Score: -0.772	 Env Dones so far: 0.00%	 Done Agents in ep: 25.00%	 In deadlock 75.00%(at switch 0)
		 Not started 0	 Eps: 0.66	EP ended at step: 416/412	Mean state_value: [4.613625]	 Epoch avg_loss: 45.71013307571411
 ------LEARNING------
------LEARNING------
------LEARNING------
Ep: 52	 5 Agents on (25,25).	 Ep score -66.200	Avg Score: -0.159	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.66	EP ended at step: 162/416	Mean state_value: [4.474066]	 Epoch avg_loss: 2.2238094011942544
 ------LEARNING------
------LEARNING------
Ep: 53	 6 Agents on (25,25).	 Ep score -162.500	Avg Score: -0.387	 Env Dones so far: 0.00%	 Done Agents in ep: 66.67%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.65	EP ended at step: 424/420	Mean state_value: [4.9148054]	 Epoch avg_loss: 4.440535068511963
 ------LEARNING------
Ep: 54	 7 Agents on (25,25).	 Ep score -426.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)
		 Not started 0	 Eps: 0.65	EP ended at step: 428/424	Mean state_value: [4.535508]	 Epoch avg_loss: 2.2039918899536133
 ------LEARNING------
------LEARNING------
------LEARNING------
Ep: 55	 8 Agents on (25,25).	 Ep score -430.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 62.50%(at switch 0)
		 Not started 0	 Eps: 0.64	EP ended at step: 432/428	Mean state_value: [4.983166]	 Epoch avg_loss: 1.8423786163330078
 ------LEARNING------
------LEARNING------
Ep: 56	 1 Agents on (25,25).	 Ep score -252.000	Avg Score: -0.583	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.64	EP ended at step: 254/432	Mean state_value: [4.6456]	 Epoch avg_loss: 1.9213834404945374
 ------LEARNING------
Ep: 57	 2 Agents on (25,25).	 Ep score -21.500	Avg Score: -0.053	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.63	EP ended at step: 33/404	Mean state_value: [4.9281673]	 Epoch avg_loss: 1.5187630653381348
 ------LEARNING------
Ep: 58	 3 Agents on (25,25).	 Ep score -39.667	Avg Score: -0.097	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.63	EP ended at step: 77/408	Mean state_value: [5.0035105]	 Epoch avg_loss: 1.8763480186462402
 ------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
Ep: 59	 4 Agents on (25,25).	 Ep score -66.000	Avg Score: -0.160	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.62	EP ended at step: 119/412	Mean state_value: [5.0655146]	 Epoch avg_loss: 3.5991944074630737
 ------LEARNING------
Ep: 60	 5 Agents on (25,25).	 Ep score -337.400	Avg Score: -0.811	 Env Dones so far: 0.00%	 Done Agents in ep: 20.00%	 In deadlock 80.00%(at switch 0)
		 Not started 0	 Eps: 0.62	EP ended at step: 420/416	Mean state_value: [5.0173]	 Epoch avg_loss: 65.14413452148438
 --------------- TESTING STARTED ------------------
Ep: 0	 1 Agents on (25,25).	 Ep score -22.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 24/404
Ep: 1	 1 Agents on (25,25).	 Ep score -402.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 404/404
Ep: 2	 1 Agents on (25,25).	 Ep score -31.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 33/404
Ep: 0	 2 Agents on (25,25).	 Ep score -27.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 34/408
Ep: 1	 2 Agents on (25,25).	 Ep score -217.500	 Done Agents in ep: 50.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 408/408
Ep: 2	 2 Agents on (25,25).	 Ep score -113.500	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 144/408
Ep: 0	 3 Agents on (25,25).	 Ep score -29.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 35/412
Ep: 1	 3 Agents on (25,25).	 Ep score -283.667	 Done Agents in ep: 33.33%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 412/412
Ep: 2	 3 Agents on (25,25).	 Ep score -146.333	 Done Agents in ep: 66.67%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 412/412
Ep: 0	 4 Agents on (25,25).	 Ep score -220.750	 Done Agents in ep: 50.00%	 In deadlock 50.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 1	 4 Agents on (25,25).	 Ep score -122.750	 Done Agents in ep: 75.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 2	 4 Agents on (25,25).	 Ep score -214.250	 Done Agents in ep: 50.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 0	 5 Agents on (25,25).	 Ep score -339.000	 Done Agents in ep: 20.00%	 In deadlock 80.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 1	 5 Agents on (25,25).	 Ep score -260.200	 Done Agents in ep: 40.00%	 In deadlock 60.00%(at switch 2)	 Not started 0	EP ended at step: 420/420
Ep: 2	 5 Agents on (25,25).	 Ep score -184.800	 Done Agents in ep: 60.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 0	 6 Agents on (25,25).	 Ep score -355.500	 Done Agents in ep: 16.67%	 In deadlock 83.33%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 1	 6 Agents on (25,25).	 Ep score -422.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 3)	 Not started 0	EP ended at step: 424/424
Ep: 2	 6 Agents on (25,25).	 Ep score -290.500	 Done Agents in ep: 33.33%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 0	 7 Agents on (25,25).	 Ep score -368.429	 Done Agents in ep: 14.29%	 In deadlock 85.71%(at switch 0)	 Not started 0	EP ended at step: 428/428
Ep: 1	 7 Agents on (25,25).	 Ep score -46.714	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 110/428
Ep: 2	 7 Agents on (25,25).	 Ep score -308.286	 Done Agents in ep: 28.57%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 428/428
Ep: 0	 8 Agents on (25,25).	 Ep score -379.125	 Done Agents in ep: 12.50%	 In deadlock 87.50%(at switch 0)	 Not started 0	EP ended at step: 432/432
Ep: 1	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 25.00%(at switch 0)	 Not started 0	EP ended at step: 432/432
Ep: 2	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)	 Not started 0	EP ended at step: 432/432
AGENT: Saving local and target networks
Epoch 60, testing agents on 3: Avg. done agents: 47.93154761904761% | Avg. reward: -1258.0 | Avg. normalized reward: -23.296296296296298 | Avg. agents in deadlock: 27.981150793650794%| LR: 0.005399999999999992
Replay memory saved
------LEARNING------
------LEARNING------
------LEARNING------
Ep: 61	 6 Agents on (25,25).	 Ep score -354.833	Avg Score: -0.845	 Env Dones so far: 0.00%	 Done Agents in ep: 16.67%	 In deadlock 83.33%(at switch 0)
		 Not started 0	 Eps: 0.61	EP ended at step: 424/420	Mean state_value: [5.140599]	 Epoch avg_loss: 3.341576178868612
 ------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
Ep: 62	 7 Agents on (25,25).	 Ep score -206.857	Avg Score: -0.488	 Env Dones so far: 0.00%	 Done Agents in ep: 71.43%	 In deadlock 28.57%(at switch 0)
		 Not started 0	 Eps: 0.61	EP ended at step: 428/424	Mean state_value: [5.1241946]	 Epoch avg_loss: 3.832618832588196
 ------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
Ep: 63	 8 Agents on (25,25).	 Ep score -382.875	Avg Score: -0.895	 Env Dones so far: 0.00%	 Done Agents in ep: 12.50%	 In deadlock 75.00%(at switch 0)
		 Not started 0	 Eps: 0.60	EP ended at step: 432/428	Mean state_value: [5.614338]	 Epoch avg_loss: 2.783709658516778
 ------LEARNING------
Ep: 64	 1 Agents on (25,25).	 Ep score -147.000	Avg Score: -0.340	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.60	EP ended at step: 149/432	Mean state_value: [5.7841125]	 Epoch avg_loss: 3.3641490936279297
 ------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
Ep: 65	 2 Agents on (25,25).	 Ep score -406.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.59	EP ended at step: 408/404	Mean state_value: [5.7933125]	 Epoch avg_loss: 3.5391786098480225
 ------LEARNING------
------LEARNING------
Ep: 66	 3 Agents on (25,25).	 Ep score -53.667	Avg Score: -0.132	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.59	EP ended at step: 98/408	Mean state_value: [5.9989147]	 Epoch avg_loss: 3.0728904008865356
 ------LEARNING------
Ep: 67	 4 Agents on (25,25).	 Ep score -319.250	Avg Score: -0.775	 Env Dones so far: 0.00%	 Done Agents in ep: 25.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.58	EP ended at step: 416/412	Mean state_value: [6.340916]	 Epoch avg_loss: 2.5765676498413086
 ------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
Ep: 68	 5 Agents on (25,25).	 Ep score -337.400	Avg Score: -0.811	 Env Dones so far: 0.00%	 Done Agents in ep: 20.00%	 In deadlock 80.00%(at switch 0)
		 Not started 0	 Eps: 0.58	EP ended at step: 420/416	Mean state_value: [6.277182]	 Epoch avg_loss: 3.517387866973877
 ------LEARNING------
------LEARNING------
Ep: 69	 6 Agents on (25,25).	 Ep score -422.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)
		 Not started 0	 Eps: 0.57	EP ended at step: 424/420	Mean state_value: [6.366374]	 Epoch avg_loss: 2.22971647977829
 ------LEARNING------
------LEARNING------
------LEARNING------
Ep: 70	 7 Agents on (25,25).	 Ep score -426.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 3)
		 Not started 0	 Eps: 0.57	EP ended at step: 428/424	Mean state_value: [6.998051]	 Epoch avg_loss: 3.263340393702189
 --------------- TESTING STARTED ------------------
Ep: 0	 1 Agents on (25,25).	 Ep score -22.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 24/404
Ep: 1	 1 Agents on (25,25).	 Ep score -30.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 32/404
Ep: 2	 1 Agents on (25,25).	 Ep score -31.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 33/404
Ep: 0	 2 Agents on (25,25).	 Ep score -27.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 34/408
Ep: 1	 2 Agents on (25,25).	 Ep score -28.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 31/408
Ep: 2	 2 Agents on (25,25).	 Ep score -27.500	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 30/408
Ep: 0	 3 Agents on (25,25).	 Ep score -29.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 35/412
Ep: 1	 3 Agents on (25,25).	 Ep score -283.667	 Done Agents in ep: 33.33%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 412/412
Ep: 2	 3 Agents on (25,25).	 Ep score -146.333	 Done Agents in ep: 66.67%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 412/412
Ep: 0	 4 Agents on (25,25).	 Ep score -318.500	 Done Agents in ep: 25.00%	 In deadlock 75.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 1	 4 Agents on (25,25).	 Ep score -122.750	 Done Agents in ep: 75.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 2	 4 Agents on (25,25).	 Ep score -214.250	 Done Agents in ep: 50.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 0	 5 Agents on (25,25).	 Ep score -418.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 1)	 Not started 0	EP ended at step: 420/420
Ep: 1	 5 Agents on (25,25).	 Ep score -260.200	 Done Agents in ep: 40.00%	 In deadlock 60.00%(at switch 2)	 Not started 0	EP ended at step: 420/420
Ep: 2	 5 Agents on (25,25).	 Ep score -263.800	 Done Agents in ep: 40.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 0	 6 Agents on (25,25).	 Ep score -355.333	 Done Agents in ep: 16.67%	 In deadlock 83.33%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 1	 6 Agents on (25,25).	 Ep score -422.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 2)	 Not started 0	EP ended at step: 424/424
Ep: 2	 6 Agents on (25,25).	 Ep score -356.333	 Done Agents in ep: 16.67%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 0	 7 Agents on (25,25).	 Ep score -368.286	 Done Agents in ep: 14.29%	 In deadlock 85.71%(at switch 0)	 Not started 0	EP ended at step: 428/428
Ep: 1	 7 Agents on (25,25).	 Ep score -113.571	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 229/428
Ep: 2	 7 Agents on (25,25).	 Ep score -369.571	 Done Agents in ep: 14.29%	 In deadlock 42.86%(at switch 2)	 Not started 0	EP ended at step: 428/428
Ep: 0	 8 Agents on (25,25).	 Ep score -379.000	 Done Agents in ep: 12.50%	 In deadlock 87.50%(at switch 0)	 Not started 0	EP ended at step: 432/432
Ep: 1	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 432/432
Ep: 2	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)	 Not started 0	EP ended at step: 432/432
Epoch 70, testing agents on 3: Avg. done agents: 50.18353174603174% | Avg. reward: -1322.4583333333333 | Avg. normalized reward: -24.48996913580247 | Avg. agents in deadlock: 30.600198412698415%| LR: 0.011399999999999997
Replay memory saved
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
Ep: 71	 8 Agents on (25,25).	 Ep score -295.000	Avg Score: -0.689	 Env Dones so far: 0.00%	 Done Agents in ep: 37.50%	 In deadlock 37.50%(at switch 1)
		 Not started 0	 Eps: 0.57	EP ended at step: 432/428	Mean state_value: [7.3948536]	 Epoch avg_loss: 3.934747024015947
Ep: 72	 1 Agents on (25,25).	 Ep score -24.000	Avg Score: -0.056	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.56	EP ended at step: 26/432	Mean state_value: [7.9859285]	 Epoch avg_loss: None
 ------LEARNING------
Ep: 73	 2 Agents on (25,25).	 Ep score -18.500	Avg Score: -0.046	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.56	EP ended at step: 21/404	Mean state_value: [7.1748886]	 Epoch avg_loss: 4.352515697479248
 ------LEARNING------
Ep: 74	 3 Agents on (25,25).	 Ep score -284.667	Avg Score: -0.698	 Env Dones so far: 0.00%	 Done Agents in ep: 33.33%	 In deadlock 66.67%(at switch 2)
		 Not started 0	 Eps: 0.55	EP ended at step: 412/408	Mean state_value: [8.027685]	 Epoch avg_loss: 3.8231394290924072
 ------LEARNING------
Ep: 75	 4 Agents on (25,25).	 Ep score -318.750	Avg Score: -0.774	 Env Dones so far: 0.00%	 Done Agents in ep: 25.00%	 In deadlock 75.00%(at switch 0)
		 Not started 0	 Eps: 0.55	EP ended at step: 416/412	Mean state_value: [7.28041]	 Epoch avg_loss: 3.3172621726989746
 ------LEARNING------
Ep: 76	 5 Agents on (25,25).	 Ep score -418.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)
		 Not started 0	 Eps: 0.54	EP ended at step: 420/416	Mean state_value: [6.506332]	 Epoch avg_loss: 4.484297275543213
 ------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
Ep: 77	 6 Agents on (25,25).	 Ep score -160.167	Avg Score: -0.381	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.54	EP ended at step: 293/420	Mean state_value: [6.242341]	 Epoch avg_loss: 5.645996672766549
 ------LEARNING------
------LEARNING------
Ep: 78	 7 Agents on (25,25).	 Ep score -426.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)
		 Not started 0	 Eps: 0.53	EP ended at step: 428/424	Mean state_value: [6.872076]	 Epoch avg_loss: 2.7063655853271484
 ------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
Ep: 79	 8 Agents on (25,25).	 Ep score -292.875	Avg Score: -0.684	 Env Dones so far: 0.00%	 Done Agents in ep: 37.50%	 In deadlock 37.50%(at switch 0)
		 Not started 0	 Eps: 0.53	EP ended at step: 432/428	Mean state_value: [5.792964]	 Epoch avg_loss: 3.9411483244462446
Ep: 80	 1 Agents on (25,25).	 Ep score -33.000	Avg Score: -0.076	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.53	EP ended at step: 35/432	Mean state_value: [7.0485897]	 Epoch avg_loss: None
 --------------- TESTING STARTED ------------------
Ep: 0	 1 Agents on (25,25).	 Ep score -22.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 24/404
Ep: 1	 1 Agents on (25,25).	 Ep score -402.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 404/404
Ep: 2	 1 Agents on (25,25).	 Ep score -31.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 33/404
Ep: 0	 2 Agents on (25,25).	 Ep score -406.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 408/408
Ep: 1	 2 Agents on (25,25).	 Ep score -217.500	 Done Agents in ep: 50.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 408/408
Ep: 2	 2 Agents on (25,25).	 Ep score -27.500	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 30/408
Ep: 0	 3 Agents on (25,25).	 Ep score -410.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 412/412
Ep: 1	 3 Agents on (25,25).	 Ep score -283.667	 Done Agents in ep: 33.33%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 412/412
Ep: 2	 3 Agents on (25,25).	 Ep score -48.667	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 70/412
Ep: 0	 4 Agents on (25,25).	 Ep score -414.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 1	 4 Agents on (25,25).	 Ep score -132.250	 Done Agents in ep: 75.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 2	 4 Agents on (25,25).	 Ep score -314.500	 Done Agents in ep: 25.00%	 In deadlock 50.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 0	 5 Agents on (25,25).	 Ep score -418.000	 Done Agents in ep: 0.00%	 In deadlock 40.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 1	 5 Agents on (25,25).	 Ep score -340.400	 Done Agents in ep: 20.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 2	 5 Agents on (25,25).	 Ep score -263.800	 Done Agents in ep: 40.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 0	 6 Agents on (25,25).	 Ep score -422.000	 Done Agents in ep: 0.00%	 In deadlock 50.00%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 1	 6 Agents on (25,25).	 Ep score -422.000	 Done Agents in ep: 0.00%	 In deadlock 83.33%(at switch 1)	 Not started 0	EP ended at step: 424/424
Ep: 2	 6 Agents on (25,25).	 Ep score -422.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 0	 7 Agents on (25,25).	 Ep score -426.000	 Done Agents in ep: 0.00%	 In deadlock 57.14%(at switch 0)	 Not started 0	EP ended at step: 428/428
Ep: 1	 7 Agents on (25,25).	 Ep score -308.857	 Done Agents in ep: 28.57%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 428/428
Ep: 2	 7 Agents on (25,25).	 Ep score -426.000	 Done Agents in ep: 0.00%	 In deadlock 28.57%(at switch 0)	 Not started 0	EP ended at step: 428/428
Ep: 0	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 62.50%(at switch 0)	 Not started 0	EP ended at step: 432/432
Ep: 1	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 75.00%(at switch 0)	 Not started 0	EP ended at step: 432/432
Ep: 2	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)	 Not started 0	EP ended at step: 432/432
Epoch 80, testing agents on 3: Avg. done agents: 27.99603174603175% | Avg. reward: -1612.0 | Avg. normalized reward: -29.85185185185185 | Avg. agents in deadlock: 26.939484126984127%| LR: 0.012599999999999997
Replay memory saved
------LEARNING------
Ep: 81	 2 Agents on (25,25).	 Ep score -66.500	Avg Score: -0.165	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.52	EP ended at step: 102/404	Mean state_value: [6.9848914]	 Epoch avg_loss: 3.3518195152282715
 ------LEARNING------
------LEARNING------
------LEARNING------
Ep: 82	 3 Agents on (25,25).	 Ep score -120.000	Avg Score: -0.294	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.52	EP ended at step: 234/408	Mean state_value: [7.082916]	 Epoch avg_loss: 4.502852598826091
 ------LEARNING------
------LEARNING------
------LEARNING------
Ep: 83	 4 Agents on (25,25).	 Ep score -275.250	Avg Score: -0.668	 Env Dones so far: 0.00%	 Done Agents in ep: 50.00%	 In deadlock 50.00%(at switch 0)
		 Not started 0	 Eps: 0.51	EP ended at step: 416/412	Mean state_value: [7.565922]	 Epoch avg_loss: 3.6332826614379883
 ------LEARNING------
Ep: 84	 5 Agents on (25,25).	 Ep score -418.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 60.00%(at switch 0)
		 Not started 0	 Eps: 0.51	EP ended at step: 420/416	Mean state_value: [7.8855066]	 Epoch avg_loss: 4.037698268890381
 ------LEARNING------
------LEARNING------
Ep: 85	 6 Agents on (25,25).	 Ep score -293.833	Avg Score: -0.700	 Env Dones so far: 0.00%	 Done Agents in ep: 33.33%	 In deadlock 66.67%(at switch 0)
		 Not started 0	 Eps: 0.51	EP ended at step: 424/420	Mean state_value: [7.7546988]	 Epoch avg_loss: 5.0660927295684814
 ------LEARNING------
------LEARNING------
Ep: 86	 7 Agents on (25,25).	 Ep score -367.429	Avg Score: -0.867	 Env Dones so far: 0.00%	 Done Agents in ep: 14.29%	 In deadlock 85.71%(at switch 0)
		 Not started 0	 Eps: 0.50	EP ended at step: 428/424	Mean state_value: [8.4002285]	 Epoch avg_loss: 3.433678388595581
 ------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
Ep: 87	 8 Agents on (25,25).	 Ep score -430.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.50	EP ended at step: 432/428	Mean state_value: [8.408302]	 Epoch avg_loss: 4.130668878555298
 ------LEARNING------
------LEARNING------
Ep: 88	 1 Agents on (25,25).	 Ep score -390.000	Avg Score: -0.903	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.49	EP ended at step: 392/432	Mean state_value: [8.827614]	 Epoch avg_loss: 5.137759208679199
Ep: 89	 2 Agents on (25,25).	 Ep score -406.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)
		 Not started 0	 Eps: 0.49	EP ended at step: 408/404	Mean state_value: [8.960789]	 Epoch avg_loss: None
 ------LEARNING------
Ep: 90	 3 Agents on (25,25).	 Ep score -410.000	Avg Score: -1.005	 Env Dones so far: 0.00%	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)
		 Not started 0	 Eps: 0.49	EP ended at step: 412/408	Mean state_value: [8.814848]	 Epoch avg_loss: 4.237881183624268
 --------------- TESTING STARTED ------------------
Ep: 0	 1 Agents on (25,25).	 Ep score -32.000	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 34/404
Ep: 1	 1 Agents on (25,25).	 Ep score -402.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 404/404
Ep: 2	 1 Agents on (25,25).	 Ep score -402.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 404/404
Ep: 0	 2 Agents on (25,25).	 Ep score -406.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)	 Not started 0	EP ended at step: 408/408
Ep: 1	 2 Agents on (25,25).	 Ep score -217.500	 Done Agents in ep: 50.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 408/408
Ep: 2	 2 Agents on (25,25).	 Ep score -58.500	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 91/408
Ep: 0	 3 Agents on (25,25).	 Ep score -410.000	 Done Agents in ep: 0.00%	 In deadlock 66.67%(at switch 0)	 Not started 0	EP ended at step: 412/412
Ep: 1	 3 Agents on (25,25).	 Ep score -410.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 412/412
Ep: 2	 3 Agents on (25,25).	 Ep score -410.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)	 Not started 0	EP ended at step: 412/412
Ep: 0	 4 Agents on (25,25).	 Ep score -414.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 1	 4 Agents on (25,25).	 Ep score -414.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 2	 4 Agents on (25,25).	 Ep score -414.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)	 Not started 0	EP ended at step: 416/416
Ep: 0	 5 Agents on (25,25).	 Ep score -418.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 1	 5 Agents on (25,25).	 Ep score -418.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 2	 5 Agents on (25,25).	 Ep score -418.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)	 Not started 0	EP ended at step: 420/420
Ep: 0	 6 Agents on (25,25).	 Ep score -422.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 1	 6 Agents on (25,25).	 Ep score -422.000	 Done Agents in ep: 0.00%	 In deadlock 33.33%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 2	 6 Agents on (25,25).	 Ep score -422.000	 Done Agents in ep: 0.00%	 In deadlock 0.00%(at switch 0)	 Not started 0	EP ended at step: 424/424
Ep: 0	 7 Agents on (25,25).	 Ep score -426.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)	 Not started 0	EP ended at step: 428/428
Ep: 1	 7 Agents on (25,25).	 Ep score -426.000	 Done Agents in ep: 0.00%	 In deadlock 85.71%(at switch 0)	 Not started 0	EP ended at step: 428/428
Ep: 2	 7 Agents on (25,25).	 Ep score -426.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)	 Not started 0	EP ended at step: 428/428
Ep: 0	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)	 Not started 0	EP ended at step: 432/432
Ep: 1	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)	 Not started 0	EP ended at step: 432/432
Ep: 2	 8 Agents on (25,25).	 Ep score -430.000	 Done Agents in ep: 0.00%	 In deadlock 100.00%(at switch 0)	 Not started 0	EP ended at step: 432/432
Epoch 90, testing agents on 3: Avg. done agents: 10.416666666666668% | Avg. reward: -1837.4166666666667 | Avg. normalized reward: -34.026234567901234 | Avg. agents in deadlock: 57.73809523809524%| LR: 0.006599999999999992
Replay memory saved
------LEARNING------
Ep: 91	 4 Agents on (25,25).	 Ep score -218.250	Avg Score: -0.530	 Env Dones so far: 0.00%	 Done Agents in ep: 50.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.48	EP ended at step: 416/412	Mean state_value: [8.880277]	 Epoch avg_loss: 4.197969436645508
 ------LEARNING------
------LEARNING------
------LEARNING------
------LEARNING------
Ep: 92	 5 Agents on (25,25).	 Ep score -293.400	Avg Score: -0.705	 Env Dones so far: 0.00%	 Done Agents in ep: 40.00%	 In deadlock 60.00%(at switch 0)
		 Not started 0	 Eps: 0.48	EP ended at step: 420/416	Mean state_value: [8.785795]	 Epoch avg_loss: 4.8211875557899475
 ------LEARNING------
/home/runnphoenix/work/flatland-rl/rainbow/prioritized_memory.py:43: RuntimeWarning: divide by zero encountered in power
  is_weight = np.power(self.tree.n_entries * sampling_probabilities, -self.beta)
/home/runnphoenix/work/flatland-rl/rainbow/prioritized_memory.py:44: RuntimeWarning: invalid value encountered in true_divide
  is_weight /= is_weight.max()
Traceback (most recent call last):
  File "train.py", line 456, in <module>
    main(args)
  File "train.py", line 290, in main
    ep_controller.save_experience_and_train(a, railenv_action_dict[a], all_rewards[a], next_obs[a], done[a], step, args, ep, mean_fields[a], next_q_values[a])
  File "/home/runnphoenix/work/flatland-rl/rainbow/graph_for_observation.py", line 251, in save_experience_and_train
    step_loss = self.rl_agent.step(
  File "/home/runnphoenix/work/flatland-rl/rainbow/dueling_double_dqn.py", line 161, in step
    return self.learn(GAMMA, ep)
  File "/home/runnphoenix/work/flatland-rl/rainbow/dueling_double_dqn.py", line 279, in learn
    Q_expected = self.compute_Q_values(states, mean_fields, "local")
  File "/home/runnphoenix/work/flatland-rl/rainbow/dueling_double_dqn.py", line 380, in compute_Q_values
    new_x = torch.cat([data.x, mean_fields[i].to(device).repeat(data.x.shape[0], 1)], dim=1)
AttributeError: 'dict' object has no attribute 'to'