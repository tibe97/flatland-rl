About to train 2 agents on (25,25) env.
Parameters:
max_num_cities: 2
max_rails_between_cities: 2
max_rails_in_city: 4
malfunction_rate: 0
max_duration: 50
min_duration: 20
num_episodes: 1000
starting from episode: 0
max_steps: 408
eps_initial: 1
eps_decay_rate: 0.999
learning_rate: 0.005
learning_rate_decay: 1.0
done_reward: 0
deadlock_reward: -1000
attention_0.att_l                                         (1, 4, 10)
attention_0.att_r                                         (1, 4, 10)
attention_0.bias                                               (40,)
attention_0.lin_l.weight                                    (40, 12)
attention_1.att_l                                         (1, 4, 10)
attention_1.att_r                                         (1, 4, 10)
attention_1.bias                                               (40,)
attention_1.lin_l.weight                                    (40, 40)
attention_2.att_l                                         (1, 4, 10)
attention_2.att_r                                         (1, 4, 10)
attention_2.bias                                               (40,)
attention_2.lin_l.weight                                    (40, 40)
out_att.att_l                                              (1, 1, 1)
out_att.att_r                                              (1, 1, 1)
out_att.bias                                                    (1,)
out_att.lin_l.weight                                         (1, 40)
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
filename is: test_results/
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
<class 'torch.Tensor'> 0 <class 'torch.Tensor'> 0
Ep: 1	 2 Agents on (25,25).	 Ep score -157.500	Avg Score: -0.386	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.80	EP ended at step: 225/408	Mean state_value: [-0.11955028]	 Epoch avg_loss: None
 [tensor([-0.1784], device='cuda:0'), tensor([-0.0638], device='cuda:0'), tensor([0.1278], device='cuda:0'), tensor([-0.0318], device='cuda:0'), tensor([-0.0985], device='cuda:0'), tensor([0.0032], device='cuda:0'), tensor([0.0983], device='cuda:0'), tensor([-0.4987], device='cuda:0'), tensor([-0.8179], device='cuda:0'), tensor([0.4578], device='cuda:0'), tensor([0.4069], device='cuda:0'), tensor([0.0760], device='cuda:0'), tensor([0.0464], device='cuda:0'), tensor([0.5010], device='cuda:0'), tensor([0.1200], device='cuda:0'), tensor([-0.1358], device='cuda:0'), tensor([-0.0662], device='cuda:0'), tensor([-0.4134], device='cuda:0'), tensor([0.1651], device='cuda:0'), tensor([-0.6400], device='cuda:0'), tensor([-0.0318], device='cuda:0'), tensor([-0.0880], device='cuda:0'), tensor([0.0032], device='cuda:0'), tensor([-1.6338], device='cuda:0'), tensor([-0.4987], device='cuda:0'), tensor([-0.8179], device='cuda:0'), tensor([0.4578], device='cuda:0'), tensor([0.0760], device='cuda:0'), tensor([0.5010], device='cuda:0'), tensor([-0.0662], device='cuda:0'), tensor([-0.0489], device='cuda:0'), tensor([-0.0638], device='cuda:0'), tensor([-0.0985], device='cuda:0'), tensor([0.0032], device='cuda:0'), tensor([-0.4987], device='cuda:0'), tensor([-0.8179], device='cuda:0'), tensor([0.4578], device='cuda:0'), tensor([0.0760], device='cuda:0'), tensor([0.5010], device='cuda:0'), tensor([-0.0662], device='cuda:0'), tensor([-0.0489], device='cuda:0'), tensor([-0.0880], device='cuda:0'), tensor([0.0032], device='cuda:0'), tensor([-0.4987], device='cuda:0'), tensor([-1.1513], device='cuda:0')]
[array([-0.17840947], dtype=float32), array([-0.06380284], dtype=float32), array([0.12781684], dtype=float32), array([-0.03177946], dtype=float32), array([-0.09852491], dtype=float32), array([0.00316688], dtype=float32), array([0.09828231], dtype=float32), array([-0.49874985], dtype=float32), array([-0.81785077], dtype=float32), array([0.45781654], dtype=float32), array([0.4069403], dtype=float32), array([0.07604408], dtype=float32), array([0.04638135], dtype=float32), array([0.5010482], dtype=float32), array([0.1199661], dtype=float32), array([-0.13575353], dtype=float32), array([-0.06618527], dtype=float32), array([-0.41338998], dtype=float32), array([0.16513577], dtype=float32), array([-0.640031], dtype=float32), array([-0.03177946], dtype=float32), array([-0.08795694], dtype=float32), array([0.00316688], dtype=float32), array([-1.6337721], dtype=float32), array([-0.49874985], dtype=float32), array([-0.81785077], dtype=float32), array([0.45781654], dtype=float32), array([0.07604408], dtype=float32), array([0.5010482], dtype=float32), array([-0.06618527], dtype=float32), array([-0.04889669], dtype=float32), array([-0.06380284], dtype=float32), array([-0.09852491], dtype=float32), array([0.00316688], dtype=float32), array([-0.49874985], dtype=float32), array([-0.81785077], dtype=float32), array([0.45781654], dtype=float32), array([0.07604408], dtype=float32), array([0.5010482], dtype=float32), array([-0.06618527], dtype=float32), array([-0.04889669], dtype=float32), array([-0.08795694], dtype=float32), array([0.00316688], dtype=float32), array([-0.49874985], dtype=float32), array([-1.151295], dtype=float32)]
Traceback (most recent call last):
  File "train.py", line 386, in <module>
    main(args)
  File "train.py", line 235, in main
    wandb_log_dict = ep_controller.retrieve_wandb_log()
  File "/home/runnphoenix/work/flatland-rl/rainbow/graph_for_observation.py", line 378, in retrieve_wandb_log
    wandb_log_dict.update({"node_values": wandb.Histogram(np.array(self.path_values_buffer))})
  File "/home/runnphoenix/anaconda3/lib/python3.8/site-packages/torch/tensor.py", line 630, in __array__
    return self.numpy()
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.