About to train 1 agents on (25,25) env.
Parameters:
max_num_cities: 2
max_rails_between_cities: 2
max_rails_in_city: 4
malfunction_rate: 0
max_duration: 50
min_duration: 20
num_episodes: 200
starting from episode: 0
max_steps: 404
eps_initial: 1
eps_decay_rate: 0.999
learning_rate: 0.02
learning_rate_decay: 0.5
done_reward: 0
deadlock_reward: -1000
batch_size: 128
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.wandb.ai:443
attention_0.att_l                                         (1, 4, 10)
attention_0.att_r                                         (1, 4, 10)
attention_0.bias                                               (40,)
attention_0.lin_l.weight                                    (40, 12)
attention_1.att_l                                         (1, 4, 10)
attention_1.att_r                                         (1, 4, 10)
attention_1.bias                                               (40,)
attention_1.lin_l.weight                                    (40, 40)
attention_2.att_l                                         (1, 4, 10)
attention_2.att_r                                         (1, 4, 10)
attention_2.bias                                               (40,)
attention_2.lin_l.weight                                    (40, 40)
out_att.att_l                                              (1, 1, 1)
out_att.att_r                                              (1, 1, 1)
out_att.bias                                                    (1,)
out_att.lin_l.weight                                         (1, 40)
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
filename is: test_results/
/home/runnphoenix/work/flatland-rl/rainbow/model.py:252: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  x = nn.functional.softmax(self.layer3(x))
DEBUG:urllib3.connectionpool:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.wandb.ai:443
DEBUG:urllib3.connectionpool:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
Ep: 1	 2 Agents on (25,25).	 Ep score -93.000	Avg Score: -0.230	 Env Dones so far: 100.00%	 Done Agents in ep: 100.00%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.86	EP ended at step: 156/404	Mean state_value: [-1.3241162]	 Epoch avg_loss: None
/home/runnphoenix/anaconda3/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Ep: 2	 3 Agents on (25,25).	 Ep score -280.000	Avg Score: -0.686	 Env Dones so far: 0.00%	 Done Agents in ep: 33.33%	 In deadlock 0.00%(at switch 0)
		 Not started 0	 Eps: 0.57	EP ended at step: 412/408	Mean state_value: [-1.3220109]	 Epoch avg_loss: None
 not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
Ep: 3	 4 Agents on (25,25).	 Ep score -318.000	Avg Score: -0.772	 Env Dones so far: 0.00%	 Done Agents in ep: 25.00%	 In deadlock 75.00%(at switch 0)
		 Not started 0	 Eps: 0.37	EP ended at step: 416/412	Mean state_value: [-1.242673]	 Epoch avg_loss: None
 not using current position
not using current position
not using current position
not using current position
not using current position
not using current position
